<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aktivitas | Master Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        :root {
            --dana-blue: #108ee9;
            --bg-light: #f5f5f5;
            --text-dark: #333;
            --text-gray: #888;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background: white; color: var(--text-dark); padding-bottom: 20px; }

        /* HEADER */
        .header {
            background: var(--dana-blue);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: white;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-left { display: flex; align-items: center; gap: 20px; }
        .header h2 { font-size: 18px; font-weight: 500; }

        /* SEARCH AREA */
        .search-area { background: var(--dana-blue); padding: 10px 15px 15px; }
        .search-box {
            background: white; border-radius: 4px; display: flex;
            align-items: center; padding: 10px 15px; gap: 10px;
        }
        .search-box input { border: none; outline: none; width: 100%; font-size: 14px; }
        .search-box i { color: var(--dana-blue); }

        /* STATUS UPDATE */
        .update-info {
            display: flex; align-items: center; gap: 8px;
            padding: 12px 20px; font-size: 11px; color: var(--text-gray);
            background: #fff; border-bottom: 8px solid #f5f5f5;
        }

        /* LIST STYLE */
        .month-label {
            padding: 15px 20px 5px; font-weight: 700; font-size: 15px;
            display: flex; justify-content: space-between;
        }
        .statement-link { color: var(--dana-blue); font-size: 13px; text-decoration: none; }

        .item-transaksi {
            display: flex; align-items: center; padding: 15px 20px;
            gap: 15px; border-bottom: 1px solid #f0f0f0;
        }
        .icon-circle {
            width: 45px; height: 45px; border-radius: 10px;
            background: #f9f9f9; border: 1px solid #eee;
            display: flex; align-items: center; justify-content: center;
            font-size: 20px; color: var(--dana-blue);
        }

        .details { flex: 1; }
        .details .title { font-size: 14px; font-weight: 600; color: #333; }
        .details .time { font-size: 11px; color: #999; }

        .amount-area { text-align: right; }
        .amount-val { font-size: 14px; font-weight: 700; margin-bottom: 2px; }
        .status-tag { 
            background: var(--dana-blue); color: white; padding: 2px 6px; 
            border-radius: 4px; font-size: 9px; display: inline-block;
        }

        .empty { text-align: center; padding: 50px; color: #ccc; font-size: 14px; }
    </style>
</head>
<body>

    <div class="header">
        <div class="header-left">
            <i class="fas fa-arrow-left" onclick="location.href='index.html'"></i>
            <h2>Aktivitas</h2>
        </div>
        <i class="fas fa-file-invoice"></i>
    </div>

    <div class="search-area">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Cari transaksi di sini...">
        </div>
    </div>

    <div class="update-info">
        <i class="fas fa-check-circle" style="color: #10b981;"></i>
        <span id="jam-update">Diupdate jam --:--</span>
    </div>

    <div class="month-label">
        <span>Bulan Ini</span>
        <a href="#" class="statement-link">Statement <i class="fas fa-chevron-right" style="font-size: 10px;"></i></a>
    </div>

    <div id="container-aktivitas">
        </div>

    <script>
        function tampilkanData() {
            const container = document.getElementById('container-aktivitas');
            const dataRaw = localStorage.getItem('kas_data');
            let listKas = dataRaw ? JSON.parse(dataRaw) : [];

            // Update Jam
            const d = new Date();
            document.getElementById('jam-update').innerText = `Diupdate jam ${d.getHours().toString().padStart(2,'0')}:${d.getMinutes().toString().padStart(2,'0')}. Tunggu yang terbaru ya.`;

            if(listKas.length === 0) {
                container.innerHTML = `<div class="empty">Belum ada riwayat transaksi.</div>`;
                return;
            }

            // --- KUNCI: DATA TERBARU DI ATAS ---
            // Kita reverse array-nya supaya yang masuk terakhir muncul paling pertama
            let dataTerbaru = [...listKas].reverse();

            let html = '';
            dataTerbaru.forEach(item => {
                const isMasuk = item.type === 'masuk';
                const icon = isMasuk ? 'fa-arrow-down' : 'fa-arrow-up';
                
                html += `
                    <div class="item-transaksi">
                        <div class="icon-circle">
                            <i class="fas ${icon}"></i>
                        </div>
                        <div class="details">
                            <p class="title">${item.note || (isMasuk ? 'Infaq Masuk' : 'Pengeluaran')}</p>
                            <p class="time">${item.date || 'Hari ini'}</p>
                        </div>
                        <div class="amount-area">
                            <p class="amount-val">
                                ${isMasuk ? '' : '-' }Rp ${parseInt(item.amount).toLocaleString('id-ID')}
                            </p>
                            <div class="status-tag"><i class="fas fa-wallet"></i></div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        window.onload = tampilkanData;
    </script>
</body>
</html>
        .status-badge {
            width: 18px;
            height: 18px;
            background: var(--dana-blue);
            color: white;
            border-radius: 4px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }

        /* EMPTY STATE */
        .empty-state { text-align: center; padding: 50px 20px; color: #bbb; }
    </style>
</head>
<body>

    <div class="header">
        <div class="header-left">
            <i class="fas fa-arrow-left" onclick="window.history.back()"></i>
            <h2>Aktivitas</h2>
        </div>
        <i class="fas fa-file-export"></i>
    </div>

    <div class="search-area">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Cari pembayaran tagihan">
            <i class="fas fa-sliders-h" style="color: #ccc; font-size: 14px;"></i>
        </div>
    </div>

    <div class="update-status">
        <i class="fas fa-spinner fa-spin"></i>
        <span id="update-time">Diupdate jam --:--. Tunggu yang terbaru ya.</span>
    </div>

    <div class="section-title-row">
        <span class="section-title">Bulan Ini</span>
        <a href="#" class="statement-link">Statement <i class="fas fa-chevron-circle-right"></i></a>
    </div>

    <div id="activity-content" class="transaction-list">
        </div>

    <script>
        function loadActivity() {
            const container = document.getElementById('activity-content');
            const dataRaw = localStorage.getItem('kas_data');
            const listKas = dataRaw ? JSON.parse(dataRaw) : [];
            
            // Set Waktu Update Realtime
            const now = new Date();
            document.getElementById('update-time').innerText = `Diupdate jam ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}. Tunggu yang terbaru ya.`;

            if (listKas.length === 0) {
                container.innerHTML = '<div class="empty-state">Belum ada riwayat transaksi</div>';
                return;
            }

            // Urutkan dari yang terbaru (sesuai SS)
            let sortedData = [...listKas].reverse();
            let html = '';

            sortedData.forEach(item => {
                const isMasuk = item.type === 'masuk';
                
                // Logika Ikon Sesuai Jenis (Bisa dimodifikasi sesuai input Bos)
                let iconHtml = '';
                if(isMasuk) {
                    iconHtml = '<i class="fas fa-plus-circle" style="color: #108ee9;"></i>';
                } else {
                    iconHtml = '<i class="fas fa-user-minus" style="color: #108ee9;"></i>';
                }

                html += `
                    <div class="transaction-item">
                        <div class="icon-box">
                            ${iconHtml}
                        </div>
                        <div class="trans-info">
                            <p class="trans-title">${item.note || (isMasuk ? 'Isi Saldo' : 'Kirim Uang')}</p>
                            <p class="trans-date">${item.date || 'Hari ini'}</p>
                        </div>
                        <div class="trans-amount">
                            <p class="amount-val ${!isMasuk ? 'minus' : ''}">
                                ${isMasuk ? '' : '-'}Rp${parseInt(item.amount).toLocaleString('id-ID')}
                            </p>
                            <div class="status-badge"><i class="fas fa-wallet"></i></div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        window.onload = loadActivity;
    </script>
</body>
</html>
