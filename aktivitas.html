<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aktivitas | Master Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        :root {
            --dana-blue: #108ee9;
            --bg-light: #f5f5f5;
            --text-dark: #333;
            --text-gray: #888;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background: white; color: var(--text-dark); }

        /* HEADER STYLE (Sesuai SS) */
        .header {
            background: var(--dana-blue);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: white;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-left { display: flex; align-items: center; gap: 20px; }
        .header h2 { font-size: 18px; font-weight: 500; }

        /* SEARCH BAR */
        .search-area {
            background: var(--dana-blue);
            padding: 10px 15px 15px;
        }
        .search-box {
            background: white;
            border-radius: 4px;
            display: flex;
            align-items: center;
            padding: 10px 15px;
            gap: 10px;
        }
        .search-box input {
            border: none;
            outline: none;
            width: 100%;
            font-size: 14px;
            color: #666;
        }
        .search-box i { color: var(--dana-blue); font-size: 18px; }

        /* UPDATE STATUS */
        .update-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 20px;
            background: white;
            color: var(--text-gray);
            font-size: 12px;
            border-bottom: 8px solid #f5f5f5;
        }

        /* TRANSAKSI LIST */
        .section-title-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: white;
        }
        .section-title { font-weight: 700; font-size: 16px; }
        .statement-link { color: var(--dana-blue); font-size: 14px; font-weight: 600; text-decoration: none; display: flex; align-items: center; gap: 5px; }

        .transaction-list { padding-bottom: 20px; }
        
        .transaction-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            gap: 15px;
            border-bottom: 1px solid #eee;
        }
        .icon-box {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            border: 1px solid #eee;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        .icon-box img { width: 30px; } /* Untuk ikon custom */
        
        .trans-info { flex: 1; }
        .trans-title { font-size: 15px; font-weight: 500; margin-bottom: 2px; }
        .trans-date { font-size: 12px; color: var(--text-gray); }

        .trans-amount {
            text-align: right;
        }
        .amount-val { font-size: 15px; font-weight: 600; margin-bottom: 2px; }
        .amount-val.minus { color: var(--text-dark); }
        .status-badge {
            width: 18px;
            height: 18px;
            background: var(--dana-blue);
            color: white;
            border-radius: 4px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
        }

        /* EMPTY STATE */
        .empty-state { text-align: center; padding: 50px 20px; color: #bbb; }
    </style>
</head>
<body>

    <div class="header">
        <div class="header-left">
            <i class="fas fa-arrow-left" onclick="window.history.back()"></i>
            <h2>Aktivitas</h2>
        </div>
        <i class="fas fa-file-export"></i>
    </div>

    <div class="search-area">
        <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Cari pembayaran tagihan">
            <i class="fas fa-sliders-h" style="color: #ccc; font-size: 14px;"></i>
        </div>
    </div>

    <div class="update-status">
        <i class="fas fa-spinner fa-spin"></i>
        <span id="update-time">Diupdate jam --:--. Tunggu yang terbaru ya.</span>
    </div>

    <div class="section-title-row">
        <span class="section-title">Bulan Ini</span>
        <a href="#" class="statement-link">Statement <i class="fas fa-chevron-circle-right"></i></a>
    </div>

    <div id="activity-content" class="transaction-list">
        </div>

    <script>
        function loadActivity() {
            const container = document.getElementById('activity-content');
            const dataRaw = localStorage.getItem('kas_data');
            const listKas = dataRaw ? JSON.parse(dataRaw) : [];
            
            // Set Waktu Update Realtime
            const now = new Date();
            document.getElementById('update-time').innerText = `Diupdate jam ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}. Tunggu yang terbaru ya.`;

            if (listKas.length === 0) {
                container.innerHTML = '<div class="empty-state">Belum ada riwayat transaksi</div>';
                return;
            }

            // Urutkan dari yang terbaru (sesuai SS)
            let sortedData = [...listKas].reverse();
            let html = '';

            sortedData.forEach(item => {
                const isMasuk = item.type === 'masuk';
                
                // Logika Ikon Sesuai Jenis (Bisa dimodifikasi sesuai input Bos)
                let iconHtml = '';
                if(isMasuk) {
                    iconHtml = '<i class="fas fa-plus-circle" style="color: #108ee9;"></i>';
                } else {
                    iconHtml = '<i class="fas fa-user-minus" style="color: #108ee9;"></i>';
                }

                html += `
                    <div class="transaction-item">
                        <div class="icon-box">
                            ${iconHtml}
                        </div>
                        <div class="trans-info">
                            <p class="trans-title">${item.note || (isMasuk ? 'Isi Saldo' : 'Kirim Uang')}</p>
                            <p class="trans-date">${item.date || 'Hari ini'}</p>
                        </div>
                        <div class="trans-amount">
                            <p class="amount-val ${!isMasuk ? 'minus' : ''}">
                                ${isMasuk ? '' : '-'}Rp${parseInt(item.amount).toLocaleString('id-ID')}
                            </p>
                            <div class="status-badge"><i class="fas fa-wallet"></i></div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        window.onload = loadActivity;
    </script>
</body>
</html>
