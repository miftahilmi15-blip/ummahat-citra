<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pohon Jariyah</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif}
body{background:#eef3f7;height:100vh;overflow:hidden}

/* ===== SCENE ===== */
#scene{
  height:60vh;
  background:linear-gradient(to top,#4CAF50,#90CAF9);
  display:flex;
  justify-content:center;
  align-items:flex-end;
  position:relative;
  overflow:hidden;
  transition:background 1s ease;
}

/* ===== POHON ===== */
.tree{
  position:relative;
  display:flex;
  flex-direction:column;
  align-items:center;
  margin-bottom:20px;
}

/* BATANG */
.trunk{
  width:28px;
  height:110px;
  background:#6D4C41;
  border-radius:8px;
  transition:height .6s ease;
  z-index:2;
}

/* KANOPI */
.leaves{
  position:relative;
  display:flex;
  justify-content:center;
  align-items:flex-end;
  margin-bottom:-35px;
}

.canopy{
  width:170px;
  height:130px;
  background:#66BB6A;
  border-radius:50%;
  transition:all .6s ease;
  box-shadow:inset -10px -10px 20px rgba(0,0,0,.08);
}

/* RUMPUT */
.grass{
  position:absolute;
  bottom:0;
  width:100%;
  height:100px;
  background:#2E7D32;
}

/* ===== UI ===== */
.ui-panel{
  height:40vh;
  background:white;
  border-radius:30px 30px 0 0;
  margin-top:-30px;
  padding:25px;
  text-align:center;
  box-shadow:0 -10px 25px rgba(0,0,0,.08);
}

.stats-card{
  background:#f7f9fb;
  padding:15px;
  border-radius:20px;
  margin-bottom:20px;
}

.btn-siram{
  width:100%;
  padding:18px;
  background:linear-gradient(to right,#4CAF50,#2E7D32);
  color:white;
  border:none;
  border-radius:50px;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
  transition:.3s;
}

.btn-siram:active{
  transform:scale(.96);
}
</style>
</head>

<body>

<div id="scene">
  <div class="tree">
    <div class="leaves">
      <div class="canopy" id="canopy"></div>
    </div>
    <div class="trunk" id="trunk"></div>
  </div>
  <div class="grass"></div>
</div>

<div class="ui-panel">
  <h3 style="margin-bottom:10px;">Pohon Jariyah</h3>
  <div class="stats-card">
    <p style="color:#777;font-size:13px;">Total Sedekah Anda</p>
    <h2 style="color:#2E7D32;">Rp <span id="total-val">0</span></h2>
  </div>
  <button class="btn-siram" onclick="location.href='kartu.html'">
    <i class="fas fa-tint"></i> SIRAM SEDEKAH SEKARANG
  </button>
</div>

<script>
function loadProgress(){
  let dataRaw = localStorage.getItem('kas_data');
  let listKas = dataRaw ? JSON.parse(dataRaw) : [];
  let total = 0;

  listKas.forEach(t=>{
    if(t.type==='masuk') total += parseInt(t.amount);
  });

  document.getElementById("total-val").innerText = total.toLocaleString();
  updateTree(total);
}

function updateTree(total){
  const trunk = document.getElementById("trunk");
  const canopy = document.getElementById("canopy");
  const scene = document.getElementById("scene");

  /* Tinggi batang */
  let trunkHeight = 110 + Math.sqrt(total)/4;
  trunk.style.height = trunkHeight + "px";

  /* Besar kanopi */
  let size = 170 + Math.sqrt(total)/3;
  canopy.style.width = size + "px";
  canopy.style.height = size*0.75 + "px";

  /* Level visual */
  let level = 1;
  if(total > 500000) level = 2;
  if(total > 2000000) level = 3;
  if(total > 5000000) level = 4;
  if(total > 10000000) level = 5;

  /* Warna per level */
  if(level==1) canopy.style.background="#81C784";
  if(level==2) canopy.style.background="#66BB6A";
  if(level==3) canopy.style.background="#43A047";
  if(level==4) canopy.style.background="#2E7D32";
  if(level==5){
    canopy.style.background="gold";
    scene.style.background="linear-gradient(to top,#2E7D32,#FFD54F)";
  }
}

window.onload = loadProgress;
</script>

</body>
</html>
